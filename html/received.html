<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Received Data</title>

    <link rel="stylesheet" href="../css/style.css">
</head>
<body>

    <h1>Received Data</h1>

    <!-- Form -->
     <form id="dataform_2">
        <!-- Received Data to display -->
        <div id="received_data"></div>

        <!-- Add another element and submit to a db -->

        <!-- Buttons to select from -->
        <div class="buttons">
            <button class="type_client" value="employer" id="employer">Employer</button>
            <button class="type_client" value="employee" id="employee">Employee</button>
        </div>

        <!-- Submit Button -->
        <button class="submit" id="submit">Submit</button>
     </form>

    <!-- <script src="../js/data_to.js"></script> -->

    <script>
        console.log("The Data To page");

        // Get URL Parameters (it's a search)
        const urlParams = new URLSearchParams(window.location.search);

        // Retrieve and decode parameters

        // First initial
        const user_first = urlParams.get('first') ? 
            decodeURIComponent(urlParams.get('first')) : 'N/A';
        // Last Name
        const user_last = urlParams.get('last') ?
            decodeURIComponent(urlParams.get('last')) : 'N/A';
        // Pin Number
        const user_pin = urlParams.get('pin') ?
            decodeURIComponent(urlParams.get('pin')) : 'N/A';

        // Display received data

        // first query the div to display data in
        const dataDisplay = document.getElementById('received_data');

        // concatenate the first init and last name
        // let result = text1.concat(text2);

        let userName = user_first.concat(user_last);
        // console.log(userName);

        // set the inner HTML in the data display div
        dataDisplay.innerHTML = `
            <p>User: ${userName}</p>
            <p>Pin: ${user_pin}</p>`
        ;

        // Client type buttons

        // Keep track of the selected button make up a value and set it to null
        let selectedButton = null;

         // First add event listeners to the button selections
            // To change the css

        // Employer
        let employer_button = document.getElementById('employer');
        // Employee
        let employee_button = document.getElementById('employee');
        // Submit
        let submit
        // Two different buttons event listener for each

        // Employer
        employer_button.addEventListener('click', () => {
            // set this as selected button
            selectedButton = employer_button.value;
            // add the 'selected' class
            employer_button.classList.add('selected');
            // remove 'selected' class from employee button
            employee_button.classList.remove('selected');
            // Test Print
            console.log("The selected button: ", selectedButton);
        });

        // Employee
        employee_button.addEventListener('click', () => {
            // set this as selected button
            selectedButton = employee_button.value;
            // add the 'selected' class
            employee_button.classList.add('selected');
            // remove 'selected' class from employee button
            employer_button.classList.remove('selected');
            // Test Print
            console.log("The selected button: ", selectedButton);
        });

        // // Employer
        // document.getElementById('employer').addEventListener('click', (e) => {
        //     // e.preventDefault();
        //     if (selectedButton) {
        //         // Remove 'selected' css class
        //         // selectedButton.classList.remove('selected');
        //         employer_button.classList.remove('selected');
        //     }
        //     selectedButton = this;
        //     console.log("Employer Selected Button");
        //     // Add 'selected' css class
        //     // selectedButton.classList.add('selected');
        //     employer_button.classList.add('selected');
        // });

        // // Employee
        // document.getElementById('employee').addEventListener('click', (e) => {
        //     // e.preventDefault();
        //     if (selectedButton) {
        //         console.log("Employee Selected Button");
        //     }
        // });



        let dataform_2 = document.getElementById('dataform_2');
        
        dataform_2.addEventListener('submit', (e) => {
            // Prevent reset of page
            e.preventDefault();
             
            // BELOW values to database
                // Test Print first

                // The User Name
                console.log(userName);

                // The Pin Number
                console.log(user_pin);

                // The Selected User Type button
                // If there is a selected button, store the value in variable
            if (selectedButton) {
                console.log('Selected option: ', selectedButton);
            }

            // NOW send to the database
        });

    </script>
    
</body>
</html>